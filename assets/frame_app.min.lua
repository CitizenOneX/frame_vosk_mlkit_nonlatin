local a=require('data.min')local b=require('battery.min')local c=require('sprite.min')local d=require('code.min')local e=require('text_sprite_block.min')TEXT_SPRITE_BLOCK=0x20;CLEAR_MSG=0x10;a.parsers[TEXT_SPRITE_BLOCK]=e.parse_text_sprite_block;a.parsers[CLEAR_MSG]=d.parse_code;function app_loop()frame.display.text(" ",1,1)frame.display.show()local f=0;local g=0;local h=false;while true do rc,err=pcall(function()local i=a.process_raw_items()if a.app_data[TEXT_SPRITE_BLOCK]~=nil then h=true;local j=a.app_data[TEXT_SPRITE_BLOCK]local k=false;for l,m in ipairs(j.sprites)do frame.display.bitmap(1,j.offsets[l].y+1,m.width,2^m.bpp,0,m.pixel_data)if l==j.lines then k=true end end;frame.display.show()if k then print('shown all sprites')for n,o in pairs(j.sprites)do j.sprites[n]=nil end;a.app_data[TEXT_SPRITE_BLOCK]=nil;collectgarbage('collect')g=frame.time.utc()end end;if a.app_data[CLEAR_MSG]~=nil then frame.display.text(" ",1,1)frame.display.show()a.app_data[CLEAR_MSG]=nil end end)if rc==false then print(err)frame.display.text(" ",1,1)frame.display.show()frame.sleep(0.04)break end;f=b.send_batt_if_elapsed(f,120)frame.sleep(0.1)if h and frame.time.utc()-g>10 then frame.display.text(" ",1,1)frame.display.show()frame.sleep(0.04)h=false end end end;app_loop()